@using Insite.Cart.Content
@using Insite.Core.Providers
@using Insite.QuickOrder.Content
@using Insite.WebFramework.Mvc.Extensions

<div ng-cloak>

    <div class="row">
        <div class="medium-9 columns">

            <div class="panel quick-order-pad">
                <h1>Quick Order Pad</h1>
                <p>@Html.Message("Quickorder_Instructions", "To add an item to your quick order form, search by keyword or item # then click on the item.")</p>
                <div class="qo-search-input">
                <input id="qo-search-view" type="text" name="textfield" ng-init="vm.autocompleteOptions.placeholder = '@T("Enter keyword or item #")'" class="qo-searchbox"
                       kendo-auto-complete k-options="vm.autocompleteOptions" ng-model="vm.searchTerm" isc-enter="vm.onEnter(vm.searchTerm)" />
                </div>
                <span id="errorMessage" ng-show="vm.errorMessage">{{vm.errorMessage}}</span>
            </div>

            <div class="cart-grid" ng-show="vm.products.length > 0">

                <ul class="item-list cart-items">
                    <li class="item-block item-header checkout-item row collapse hide-for-small-down">
                        <div class="small-6 columns col-description">
                            @T("Description")
                        </div>
                        <div class="small-2 columns col-availability">
                            @T("Availability")
                        </div >
                        <div class="small-1 columns col-price">
                            @T("Price")
                        </div>
                        <div class="small-1 columns col-qty">
                            @T("Qty")
                        </div>
                        <div class="small-2 end columns col-total">
                            @T("Total")
                        </div>
                    </li>
                    <li ng-repeat="product in vm.products">
                        <div class="item-block checkout-item">
                            <div class="row collapse">
                                <a id = "quickOrderViewRemoveProduct_{{product.id}}" class="remove" ng-click="vm.removeProduct(product)"><i class="fa fa-lg fa-remove"></i></a>
                                <div class="col-thumb xsmall-3 medium-1 columns">
                                    <isc-product-thumb product = "product" class="ng-isolate-scope"></isc-product-thumb>
                                </div>
                                <div class="col-description xsmall-9 medium-5 columns">
                                    <div class="item-brand">{{product.properties['manufacturerName']}}</div>
                                    <div class="item-name">
                                        <a id = "quickOrderViewProductLink_{{product.id}}" href="{{product.productDetailUrl}}" target="_blank">{{product.shortDescription}}</a>
                                    </div>
                                    <div class="item-num">
                                        <span class="item-num-mfg" ng-show="product.manufacturerItem">@T("MFR #") <span class="dark">{{product.manufacturerItem}}</span></span>
                                    </div>
                                    <div ng-if="product.documents.length > 0">
                                        <ul class="inline-list">
                                            <li ng-repeat="document in product.documents" class="doc-{{$index}}">
                                                <a target = "_blank" id="productDetailViewDocumentLink_{{$index}}" href="{{document.filePath}}" title="{{document.documentType}}"><i class="epicon epicon-{{document.documentType}}"></i><em class="hide">({{document.fileTypeString}})</em></a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="xsmall-3 medium-2 columns col-availability">
                                    <morsco-cart-availability-message availability = "product.availability" warehouses="vm.warehouses" itemline="product"></morsco-cart-availability-message>
                                </div>
                                <div class="xsmall-3 medium-1 columns col-price">
                                    <isc-product-price product = "product" ></ isc - product - price >

                                    < isc - unit - of - measure - display product="product" ng-if="product.properties['productType'] == 'catalog'"> </isc-unit-of-measure-display>
                                    <span data-tooltip aria-haspopup="true" class="has-tip" ng-if="product.properties['productType'] != 'catalog'" title="Add to cart and request a quote to get pricing">@T("Request Quote for Price")</span>
                                    <span class="pack-size" ng-if="product.packDescription">@T("Pack"): { { product.packDescription} }</span>
                                    <div ng-show="product.canShowPrice && !product.quoteRequired">
                                        <isc-quantity-break-pricing data-dropdown product-id="product.uuid" break-prices="product.pricing.actualBreakPrices"></isc-quantity-break-pricing>
                                    </div>
                                    <div class="um-pack">
                        				<isc-unit-of-measure-select-list product = "product"
                                                         alternate-units-of-measure="{{vm.settings.alternateUnitsOfMeasure}}"
                                                         show-pack="false"
                                                         change-unit-of-measure="vm.changeUnitOfMeasure(product)"></isc-unit-of-measure-select-list>
                                    </div>
                                </div>
                                <div class="xsmall-3 medium-1 columns col-qty">
                                    <input id="qty-{{product.id}}" type="number" min="product.properties.minimumSellQty" name="qty"
                                           ng-change="vm.updateQty(product)"
                                           isc-enter="vm.updateQty(product)"
                                           ng-model-options="{ updateOn: 'blur' }"
                                           step="{{product.properties.minimumSellQty}}" class="numerictextbox qty" ng-model="product.qtyOrdered" />

                                </div>
                                <div class="xsmall-3 medium-2 end columns col-total">
                                    <div ng-show="!product.quoteRequired" ng-if="product.properties['productType'] == 'catalog'" class="qo-subtotal">{{product.pricing.extendedActualPriceDisplay}}</div>
                                    @*<isc-product-price product="product" ng-if="product.properties['productType'] == 'catalog'"></isc-product-price>
                                    <isc-unit-of-measure-display product="product" ng-if="product.properties['productType'] == 'catalog'"> </isc-unit-of-measure-display>*@

                                    <span ng-if="product.properties['productType'] != 'catalog'">&nbsp;</span>

                                    <div class="quantity-pricing">
                                        <isc-quantity-break-pricing product-id="product.productId" break-prices="product.breakPrices"></isc-quantity-break-pricing>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>

                <div class="hide-for-small-down">
                    <div class="order-subtotal-grid">
                        <div class="row">
                            <div class="small-4 small-offset-8 end columns text-right">
                                @T("Subtotal") <ng-pluralize count="vm.products.length" when="{'0': 'No items','one': '(1 item)','other': '({} items)'}"></ng-pluralize> <strong>{{vm.grandTotal()}}</strong>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
        <div class="medium-3 columns">
            <div class="summary" ng-show="vm.products.length > 0">
                <header class="summary-header">
                    Order Summary
                </header>
                <div class="summary-content">
                    <div class="summary-totals">
                        <div class="row collapse sub-total">
                            <div class="small-6 columns sub-label">@T("Subtotal")</div>
                            <div class="small-6 columns sub-amount ng-binding">{{vm.grandTotal()}}</div>
                        </div>
                    </div>
                    <div class="summary-primary-cta">
                        <button id="quickOrderViewAddAllToCartAndCheckOutButton" class="button primary expand large" ng-click="vm.addAllToCart('@(Url.ContentPage<CartPage>())')" ng-disabled="!vm.allQtysIsValid()">@T("Add All to Cart")</button>
                    </div>
                    <div>
                        <isc-morsco-availability-shipping-tax></isc-morsco-availability-shipping-tax>
                    </div>
                </div>
            </div>
            @*<strong>OR</strong> <a id="quickOrderViewUploadAnOrderLink" ng-href="@(Url.ContentPage<OrderUploadPage>())" class="button primary">@T("Upload an Order")</a>*@
        </div>
    </div>

    <input type="hidden" id="messageConfigurableProduct" value="@Html.Message("QuickOrder_CannotOrderConfigurable", "Cannot quick order configurable products")" />
    <input type="hidden" id="messageStyledProduct" value="@Html.Message("QuickOrder_CannotOrderStyled", "Product requires styling.")" />
    <input type="hidden" id="messageUnavailable" value="@Html.Message("QuickOrder_ProductIsUnavailable", "Product is unavailable.")" />
    <input type="hidden" id="messageNotFound" value="@MessageProvider.Current.Product_NotFound" />

    <isc-morsco-availability-popup> </isc-morsco-availability-popup>

    <isc-morsco-availability-shipping-tax-content></isc-morsco-availability-shipping-tax-content>
    
</div>



